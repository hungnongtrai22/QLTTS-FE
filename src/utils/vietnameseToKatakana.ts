const vietToKatakanaMap: Record<string, string> = {
  a: 'アー',
  an: 'アン',
  anh: 'アイン',
  ba: 'バ',
  bac: 'バック',
  bach: 'バック',
  bang: 'バーン',
  bao: 'バオ',
  bay: 'バイ',
  be: 'ベ',
  beo: 'ベオ',
  bich: 'ビック',
  binh: 'ビン',
  bo: 'ボー',
  boi: 'ボイ',
  bui: 'ブイ',
  bup: 'ブップ',
  buu: 'ビュウ',
  cam: 'カム',
  canh: 'カイン',
  cao: 'カオ',
  cham: 'チャム',
  chanh: 'チャイン',
  chau: 'チャウ',
  che: 'チェー',
  chi: 'チー',
  chien: 'チエン',
  chieu: 'チエウ',
  chom: 'チョン',
  chung: 'チュン',
  chuong: 'チュオン',
  co: 'コー',
  cong: 'コン',
  cuc: 'クック',
  cuong: 'クオン',
  da: 'ヤ',
  daly: 'ダリ',
  dan: 'ザン',
  danh: 'ヤン',
  di: 'ジー',
  diem: 'ジエム',
  dieu: 'ジエウ',
  diep: 'ジエップ',
  doan: 'ヨアン',
  doanh: 'ヨアイン',
  du: 'ユー',
  dung: 'ズン',
  duong: 'ズオン',
  duy: 'ズイ',
  duyen: 'ズエン',
  đai: 'ダイ',
  đam: 'ダム',
  đang: 'ダン',
  đao: 'ダオ',
  đat: 'ダット',
  đe: 'デー',
  đen: 'デン',
  đien: 'ディエン',
  điep: 'ディエップ',
  đieu: 'ディエウ',
  đinh: 'ディン',
  đo: 'ドー',
  đoan: 'ドアン',
  đoc: 'ドック',
  đong: 'ドン',
  đuc: 'ドゥック',
  đuoc: 'ドゥオク',
  em: 'エム',
  gam: 'ガム',
  gia: 'ジャー',
  giam: 'ガム',
  giang: 'ジャン',
  giap: 'ジャップ',
  giau: 'ジャウ',
  h: 'ホー',
  ha: 'ハー',
  hi: 'ヒ',
  hai: 'ハイ',
  han: 'ハン',
  hang: 'ハン',
  hanh: 'ハイン',
  hao: 'ハオ',
  hau: 'ハウ',
  hien: 'ヒエン',
  hiep: 'ヒエップ',
  hieu: 'ヒュー',
  ho: 'ホー',
  hoa: 'ホア',
  hoan: 'ホアン',
  hoai: 'ホアイ',
  hoang: 'ホアン',
  hoc: 'ホック',
  hoi: 'ホイ',
  hong: 'ホン',
  hua: 'フア',
  huan: 'フアン',
  hue: 'フェ',
  hung: 'フーン',
  hưng: 'フン',
  huong: 'フオン',
  huu: 'フウ',
  huy: 'フイ',
  huyen: 'フエン',
  huynh: 'フイン',
  hwing: 'ホイン',
  kha: 'カー',
  khac: 'カック',
  khai: 'カイ',
  khanh: 'カイン',
  khang: 'カン',
  khien: 'キエン',
  khoa: 'コア',
  khoi: 'コア',
  khuc: 'クーク',
  khuong: 'クオン',
  kien: 'キエン',
  kiet: 'キエット',
  kieu: 'キエウ',
  kim: 'キム',
  kinh: 'キン',
  knul: 'クヌン',
  ky: 'キー',
  la: 'ラ',
  lac: 'ラック',
  lai: 'ライ',
  lam: 'ラム',
  lan: 'ラン',
  lanh: 'ライン',
  le: 'レー',
  liem: 'リエム',
  lien: 'リエン',
  lieu: 'リエウ',
  linh: 'リン',
  loan: 'ロアン',
  loc: 'ロック',
  loi: 'ロイ',
  long: 'ロン',
  luat: 'ルアット',
  luong: 'ルオン',
  luu: 'リュー',
  luc: 'ルック',
  luy: 'ルイ',
  ly: 'リー',
  nu: 'ヌー',
  nuong: "ヌオン",
  mai: 'マイ',
  man: 'マン',
  mang: 'マン',
  manh: 'マイン',
  men: 'メン',
  meo: 'メオ',
  minh: 'ミン',
  mo: 'モー',
  mong: 'モン',
  mui: 'ムイ',
  muoi: 'ムオイ',
  my: 'ミー',
  mi: 'ミー',
  na: 'ナ',
  ni: 'ニー',
  nie: '二エ',
  nam: 'ナム',
  nane: 'ナン',
  nang: 'ナン',
  nga: 'ガー',
  ngam: 'ガム',
  ngan: 'ガン',
  nghi: 'ギー',
  nghia: 'ギア',
  nghiep: 'ギエップ',
  ngo: 'ゴー',
  ngoc: 'ゴック',
  ngu: 'グー',
  nguyen: 'グエン',
  nguyet: 'グエット',
  nha: 'ニャー',
  nhan: 'ニャン',
  nhanh: 'ニャン',
  nhat: 'ニャット',
  nhi: 'ニー',
  nhieu: 'ニエウ',
  nho: 'ニョー',
  nhon: 'ニョン',
  nhu: 'ヌー',
  nhung: 'ニュン',
  nhuong: 'ニュオン',
  nhut: 'ニュット',
  ninh: 'ニン',
  noi: 'ノイ',
  nong: 'ノン',
  oanh: 'オアン',
  pha: 'ファー',
  pham: 'ファム',
  phan: 'ファン',
  phat: 'ファット',
  phi: 'フイ',
  phien: 'フィエン',
  phong: 'フォン',
  phu: 'フー',
  phuc: 'フック',
  phung: 'フーン',
  phuoc: 'フオック',
  phuong: 'フォン',
  quan: 'クアン',
  quang: 'クアン',
  qui: 'クイ',
  quoc: 'クオック',
  quy: 'クイ',
  que: 'クエ',
  quyen: 'クエン',
  quyet: 'クエット',
  quynh: 'クイン',
  sa: 'サ',
  sam: 'サム',
  san: 'サン',
  sang: 'サン',
  si: 'シー',
  sieu: 'シエウ',
  sinh: 'シン',
  son: 'ソン',
  su: 'スー',
  sua: 'スア',
  sung: 'スン',
  suong: 'スオン',
  sy: 'シー',
  rot: 'ロット',
  ta: 'ター',
  tac: 'タック',
  tai: 'タイ',
  tam: 'タム',
  tan: 'タン',
  tang: 'タン',
  tat: 'タット',
  tay: 'タイ',
  thach: 'タッチ',
  thai: 'ターイ',
  tham: 'ターム',
  than: 'タン',
  thang: 'ターン',
  thanh: 'タイン',
  thao: 'タオ',
  the: 'テー',
  thi: 'ティ',
  thien: 'ティエン',
  thiet: 'ティエット',
  thieu: 'ティエウ',
  thinh: 'ティン',
  tho: 'トー',
  thoai: 'トアイ',
  thom: 'トム',
  thong: 'トン',
  thu: 'トゥー',
  thư: 'トゥ',
  thuat: 'トゥアット',
  thuan: 'トゥアン',
  thuc: 'トゥック',
  thuong: 'トゥオン',
  thuy: 'トゥイ',
  thuyen: 'トゥエン',
  thuyet: 'トゥイット',
  tiem: 'ティエム',
  tien: 'ティエン',
  tiet: 'ティエット',
  tin: 'ティン',
  tinh: 'ティン',
  to: 'トー',
  toa: 'トア',
  toan: 'トアン',
  toi: 'トイ',
  tong: 'トン',
  thoa: 'トア',
  tra: 'チャ',
  trang: 'チャン',
  trac: 'チャック',
  tram: 'チャム',
  tran: 'チャン',
  trenh: 'チェン',
  tri: 'チー',
  trien: 'チエン',
  triet: 'チエット',
  trieu: 'チーウ',
  trinh: 'チン',
  trong: 'チョン',
  tru: 'チュー',
  truc: 'チュック',
  trung: 'チュン',
  truong: 'チュオン',
  tu: 'トゥー',
  tuan: 'トゥアン',
  tung: 'トゥン',
  tuoi: 'トゥオイ',
  tuong: 'トゥオン',
  tuot: 'トゥオット',
  tuyen: 'トゥェン',
  tuyet: 'トゥエット',
  chuyen: "チュエン",
  ty: 'テイ',
  thy: 'ティ',
  ut: 'ウット',
  ung: 'ウン',
  uyen: 'ウエン',
  van: 'バン',
  vang: 'バン',
  vien: 'ビエン',
  viet: 'ビエット',
  vinh: 'ビン',
  vo: 'ボー',
  vu: 'ブー',
  vi: 'ビ',
  vuong: 'ブオン',
  vy: 'ビー',
  xu: 'スー',
  xuan: 'スアン',
  xum: 'スム',
  xung: 'スン',
  xuyen: 'スエン',
  y: 'イー',
  yen: 'イエン',
};


const removeVietnameseTones = (str: string): string => {
  const exceptions = ['hưng', 'thư'];

  // Tách chuỗi thành từ
  const words = str.trim().split(/\s+/);

  const placeholder = '__D_PLACEHOLDER__';

  const processWord = (word: string): string => {
    const lowerWord = word.toLowerCase();

    // Nếu là từ ngoại lệ thì giữ nguyên
    if (exceptions.includes(lowerWord)) {
      return word;
    }

    // Bỏ dấu từ
    let processed = word.replace(/đ/g, placeholder).replace(/Đ/g, placeholder.toUpperCase());
    processed = processed.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    processed = processed.replace(new RegExp(placeholder, 'g'), 'đ').replace(new RegExp(placeholder.toUpperCase(), 'g'), 'Đ');
    return processed;
  };

  // Xử lý từng từ
  return words.map(processWord).join(' ');
};


export const convertToKatakana = (vietnameseName: string): string => {
  
  const normalized = removeVietnameseTones(vietnameseName.toLowerCase());
  const syllables = normalized.split(/\s+/);

  const katakanaParts = syllables.map((syllable) => vietToKatakanaMap[syllable] || syllable);

  return katakanaParts.join('・'); // dùng dấu ・ như trong cách viết Katakana tên nước ngoài
};
