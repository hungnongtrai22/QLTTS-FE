const vietToKatakanaMap: Record<string, string> = {
  an: 'アン',
  anh: 'アイン',
  ba: 'バ',
  bac: 'バック',
  bang: 'バン',
  bao: 'バオ',
  bay: 'バイ',
  be: 'ベ',
  beo: 'ベオ',
  bich: 'ビック',
  binh: 'ビン',
  bo: 'ボー',
  bui: 'ブイ',
  buu: 'ビュウ',
  cam: 'カム',
  canh: 'カン',
  cao: 'カオ',
  cham: 'チャム',
  chanh: 'チャイン',
  chau: 'チャウ',
  che: 'チェー',
  chi: 'チー',
  chien: 'チエン',
  chieu: 'チウ',
  chuong: 'チュオン',
  co: 'コー',
  cong: 'コン',
  cuc: 'クック',
  cuong: 'クオン',
  da: 'ヤ',
  danh: 'ヤン',
  di: 'ジー',
  diem: 'ジエム',
  doan: 'ヨアン',
  du: 'ユー',
  dung: 'ユン',
  duong: 'ユオン',
  duy: 'ユイ',
  duyen: 'ズエン',
  đai: 'ダイ',
  đam: 'ダム',
  đang: 'ダン',
  đao: 'ダオ',
  đat: 'ダット',
  đe: 'デ',
  đen: 'デン',
  đien: 'ディエン',
  điep: 'ディエップ',
  đieu: 'ディエウ',
  đinh: 'ディン',
  đo: 'ドー',
  đoan: 'ドアン',
  đoc: 'ドック',
  đong: 'ドン',
  đuc: 'ドゥック',
  đuoc: 'ドゥオック',
  em: 'エム',
  gam: 'ヤム',
  gia: 'ヤー',
  giang: 'ヤン',
  giap: 'ヤップ',
  giau: 'ヤウ',
  ha: 'ハー',
  hai: 'ハーイ',
  han: 'ハン',
  hang: 'ハン',
  hanh: 'ハイン',
  hao: 'ハオ',
  hau: 'ハウ',
  hien: 'ヒエン',
  hiep: 'ヒエップ',
  hieu: 'ヒエウ',
  ho: 'ホー',
  hoa: 'ホア',
  hoai: 'ホアイ',
  hoang: 'ホアン',
  hoc: 'ホック',
  hoi: 'ホイ',
  hong: 'ホン',
  hua: 'フア',
  huan: 'フアン',
  hue: 'フエ',
  hung: 'フン',
  huong: 'フーン',
  huu: 'ヒュー',
  huy: 'フイ',
  huyen: 'フエン',
  huynh: 'フイン',
  khac: 'カック',
  khai: 'カーイ',
  khanh: 'カイン',
  khien: 'キエン',
  khoa: 'コア',
  khuc: 'クーク',
  khuong: 'クオン',
  kien: 'キエン',
  kiet: 'キエンット',
  kim: 'キム',
  kinh: 'キン',
  ky: 'キー',
  la: 'ラ',
  lac: 'ラック',
  lai: 'ライ',
  lam: 'ラム',
  lan: 'ラン',
  lanh: 'ライン',
  le: 'レー',
  liem: 'リエム',
  lien: 'リエン',
  lieu: 'リエウ',
  linh: 'リン',
  loan: 'ロアン',
  loc: 'ロック',
  loi: 'ロイ',
  long: 'ロン',
  luat: 'ルアット',
  luong: 'ルオン',
  luu: 'リュー',
  luy: 'ルイ',
  ly: 'リー',
  mai: 'マイ',
  man: 'マン',
  mang: 'マン',
  manh: 'マイン',
  men: 'メン',
  meo: 'メオ',
  minh: 'ミン',
  mo: 'モー',
  mong: 'モン',
  mui: 'ムイ',
  muoi: 'ムオイ',
  my: 'ミー',
  na: 'ナ',
  nam: 'ナム',
  nang: 'ナン',
  nga: 'ガー',
  ngan: 'ガン',
  nghi: 'ギ',
  nghia: 'ギア',
  nghiep: 'ギエッフ',
  ngo: 'ゴー',
  ngoc: 'ゴック',
  ngu: 'グー',
  nguyen: 'グエン',
  nguyet: 'グエット',
  nha: 'ニアー',
  nhan: 'ニアン',
  nhat: 'ニアット',
  nhi: 'ニー',
  nhieu: 'ニエウ',
  nho: 'ニョー',
  nhon: 'ニョン',
  nhu: 'ニュー',
  nhung: 'ニュン',
  nhuong: 'ニュオン',
  nhut: 'ニュット',
  ninh: 'ニン',
  noi: 'ノイ',
  oanh: 'オアン',
  pha: 'フア',
  pham: 'ファム',
  phan: 'ファン',
  phat: 'ファット',
  phi: 'フイ',
  phong: 'フオン',
  phu: 'フー',
  phuc: 'フック',
  phung: 'フン',
  phuoc: 'フオック',
  phuong: 'フーン',
  quan: 'クアン',
  quang: 'クアン',
  qui: 'クイ',
  quoc: 'クオック',
  quy: 'クイ',
  quyen: 'クエン',
  quyet: 'クエット',
  quynh: 'クイン',
  sam: 'サム',
  san: 'サン',
  sang: 'サン',
  si: 'シー',
  sieu: 'シエウ',
  sinh: 'シン',
  son: 'ソン',
  su: 'スー',
  sua: 'スア',
  sung: 'スン',
  sy: 'シー',
  ta: 'ター',
  tac: 'タック',
  tai: 'タイ',
  tam: 'タム',
  tan: 'タン',
  tang: 'タン',
  tat: 'タット',
  tay: 'タイ',
  thach: 'タック',
  thai: 'ターイ',
  tham: 'タム',
  than: 'タン',
  thang: 'タン',
  thanh: 'タイン',
  thao: 'タオ',
  the: 'テー',
  thi: 'ティ',
  thien: 'ティエン',
  thiet: 'ティエット',
  thieu: 'ティエウ',
  thinh: 'ティン',
  tho: 'トー',
  thoai: 'トアイ',
  thom: 'トム',
  thong: 'トン',
  thu: 'トゥー',
  thuat: 'トゥアット',
  thuan: 'トゥアン',
  thuc: 'トゥック',
  thuong: 'トゥオン',
  thuy: 'トゥイ',
  thuyen: 'トゥエン',
  thuyet: 'トゥイット',
  tiem: 'ティエム',
  tien: 'ティエン',
  tiet: 'ティエット',
  tin: 'ティン',
  tinh: 'ティン',
  to: 'トー',
  toan: 'トアン',
  toi: 'トイ',
  tong: 'トン',
  tra: 'チャー',
  trac: 'チャック',
  tram: 'チャム',
  tran: 'チャン',
  tri: 'チ',
  trien: 'チエン',
  triet: 'チエット',
  trieu: 'チウ',
  trinh: 'チン',
  trong: 'チョン',
  tru: 'チュー',
  truc: 'チュック',
  trung: 'チュン',
  truong: 'チュオン',
  tu: 'トゥ',
  tuan: 'トゥアン',
  tung: 'トゥン',
  tuoi: 'トゥオイ',
  tuong: 'トゥオン',
  tuot: 'トゥオット',
  tuyen: 'トゥエン',
  ty: 'テイ',
  ut: 'ウット',
  uyen: 'ウエン',
  van: 'バン',
  vang: 'バン',
  vien: 'ビエン',
  viet: 'ビエット',
  vinh: 'ビン',
  vo: 'ボー',
  vu: 'ブー',
  vuong: 'ブオン',
  vy: 'ビー',
  xu: 'スー',
  xuan: 'スアン',
  xum: 'スム',
  xung: 'スン',
  xuyen: 'スエン',
  y: 'イ',
  yen: 'イエン',
};

const removeVietnameseTones = (str: string): string => {
  // Bước 1: Tạm thời thay đ/Đ bằng ký hiệu tạm để không bị mất khi normalize
  const placeholder = '__D_PLACEHOLDER__';
  str = str.replace(/đ/g, placeholder).replace(/Đ/g, placeholder.toUpperCase());

  // Bước 2: Loại bỏ các dấu thanh bằng Unicode normalize
  str = str.normalize('NFD').replace(/[\u0300-\u036f]/g, '');

  // Bước 3: Khôi phục lại đ/Đ
  str = str
    .replace(new RegExp(placeholder, 'g'), 'đ')
    .replace(new RegExp(placeholder.toUpperCase(), 'g'), 'Đ');

  return str;
};

export const convertToKatakana = (vietnameseName: string): string => {
  const normalized = removeVietnameseTones(vietnameseName.toLowerCase());
  const syllables = normalized.split(/\s+/);

  const katakanaParts = syllables.map((syllable) => vietToKatakanaMap[syllable] || syllable);

  return katakanaParts.join('・'); // dùng dấu ・ như trong cách viết Katakana tên nước ngoài
};
